{
	"name": "MIMS Insert to tblService",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "MIMScsv",
						"type": "DatasetReference"
					},
					"name": "MIMSservice"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "a_tblService",
						"type": "DatasetReference"
					},
					"name": "tblService",
					"rejectedDataLinkedService": {
						"referenceName": "smpkpi",
						"type": "LinkedServiceReference"
					}
				}
			],
			"transformations": [
				{
					"name": "DateConversions"
				}
			],
			"script": "parameters{\n\tDatasource as string\n}\nsource(output(\n\t\tCoopID as string,\n\t\tCoopName as string,\n\t\tProdID as string,\n\t\tProdName as string,\n\t\tManifestNum as string,\n\t\tLT_No as string,\n\t\tCustID as string,\n\t\tCustName as string,\n\t\tHaulerID as string,\n\t\tHaulerName as string,\n\t\tScaleHeavy as string,\n\t\tSchPickUpDate as string,\n\t\tActualPickUpDate as string,\n\t\tSchDeliveryDate as string,\n\t\tActualDeliveryDate as string,\n\t\tRouteNum as string,\n\t\tRejected as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: true,\n\trowUrlColumn: 'Datasource',\n\twildcardPaths:['*.csv']) ~> MIMSservice\nMIMSservice derive(Updated = currentTimestamp(),\n\t\tSchPickUpDate = iif(length(SchPickUpDate)>10, toTimestamp(SchPickUpDate,\"yyyy-MM-dd\\'T\\'HH:mm:ss\"), toTimestamp(concat(SchPickUpDate,\"T00:00:00.000Z\"),\"yyyy-MM-dd\\'T\\'HH:mm:ss\")   ),\n\t\tSchPickUpDate2 = toTimestamp(SchPickUpDate,\"MM/dd/yyyy H:mm\"),\n\t\tActualPickUpDate = iif(length(ActualPickUpDate)>10, toTimestamp(ActualPickUpDate,\"yyyy-MM-dd\\'T\\'HH:mm:ss\"), toTimestamp(concat(ActualPickUpDate,\"T00:00:00.000Z\"),\"yyyy-MM-dd\\'T\\'HH:mm:ss\")   ),\n\t\tSchDeliveryDate = iif(length(SchDeliveryDate)>10, toTimestamp(SchDeliveryDate,\"yyyy-MM-dd\\'T\\'HH:mm:ss\"), toTimestamp(concat(SchDeliveryDate,\"T00:00:00.000Z\"),\"yyyy-MM-dd\\'T\\'HH:mm:ss\")   ),\n\t\tActualDeliveryDate = iif(length(ActualDeliveryDate)>10, toTimestamp(ActualDeliveryDate,\"yyyy-MM-dd\\'T\\'HH:mm:ss\"), toTimestamp(concat(ActualDeliveryDate,\"T00:00:00.000Z\"),\"yyyy-MM-dd\\'T\\'HH:mm:ss\")   ),\n\t\tActualPickUpDate2 = toTimestamp(ActualPickUpDate,\"MM/dd/yyyy H:mm\"),\n\t\tSchDeliveryDate2 = toTimestamp(SchDeliveryDate,\"MM/dd/yyyy H:mm\"),\n\t\tActualDeliveryDate2 = toTimestamp(ActualDeliveryDate,\"MM/dd/yyyy H:mm\")) ~> DateConversions\nDateConversions sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tCoopID as string,\n\t\tCoopName as string,\n\t\tProdID as double,\n\t\tProdName as string,\n\t\tManifestNum as string,\n\t\tLT_No as double,\n\t\tCustID as double,\n\t\tCustName as string,\n\t\tHaulerID as string,\n\t\tHaulerName as string,\n\t\tScaleHeavy as double,\n\t\tSchPickUpDate as timestamp,\n\t\tActualPickUpDate as timestamp,\n\t\tSchDeliveryDate as timestamp,\n\t\tActualDeliveryDate as timestamp,\n\t\tRouteNum as string,\n\t\tRejected as double,\n\t\tServiceID as integer,\n\t\tDatasource as string,\n\t\tUpdated as timestamp\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tdateFormat:'yyyy-MM-dd',\n\ttimestampFormat:'HH:mm:ss',\n\tbooleanFormat: ['1', '0'],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'allErrors',\n\toutputRejectedData: true,\n\trejectedData_container: 'processlogs',\n\trejectedData_folderPath: 'rejectedRecords',\n\ttransactionCommit: 'single',\n\treportSuccessOnError: true,\n\tmapColumn(\n\t\tCoopID,\n\t\tCoopName,\n\t\tProdID,\n\t\tProdName,\n\t\tManifestNum,\n\t\tLT_No,\n\t\tCustID,\n\t\tCustName,\n\t\tHaulerID,\n\t\tHaulerName,\n\t\tScaleHeavy,\n\t\tSchPickUpDate,\n\t\tActualPickUpDate,\n\t\tSchDeliveryDate,\n\t\tActualDeliveryDate,\n\t\tRouteNum,\n\t\tRejected,\n\t\tDatasource,\n\t\tUpdated\n\t)) ~> tblService"
		}
	}
}